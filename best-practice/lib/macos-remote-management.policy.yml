# Fleet's Fleet Enterprise Edition (EE) license applies to the code in this file. Read about the license here: https://github.com/fleetdm/fleet/blob/main/ee/LICENSE

policy:
  name: macOS - CIS - Ensure Remote Management is disabled
  platform: darwin
  description: |
    Remote Management is the client portion of Apple Remote Desktop (ARD).
    Remote Management can be used by remote administrators to view the current screen,
    install software, report on, and generally manage client Macs.
    Remote Management should only be enabled on trusted networks with strong
    user controls present in a Directory system.
    Mobile devices without strict controls are vulnerable to exploit and monitoring.
  resolution: |
    Graphical Method:
    1. Open System Settings
    2. Select General
    3. Select Sharing
    4. Set Remote Management to disabled
  query: |
    SELECT 1 WHERE NOT EXISTS (
      SELECT * FROM processes WHERE
        path = '/System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/MacOS/ARDAgent'
    );